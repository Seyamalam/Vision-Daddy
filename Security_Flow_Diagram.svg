<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1154pt" height="314pt" viewBox="0.00 0.00 1154.00 314.40">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 310.4)">
<title>Security_Flow_WSS_Auth</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-310.4 1150,-310.4 1150,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_seq</title>
<path fill="white" stroke="white" d="M20,-8C20,-8 1126,-8 1126,-8 1132,-8 1138,-14 1138,-20 1138,-20 1138,-286.4 1138,-286.4 1138,-292.4 1132,-298.4 1126,-298.4 1126,-298.4 20,-298.4 20,-298.4 14,-298.4 8,-292.4 8,-286.4 8,-286.4 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="573" y="-280" font-family="Helvetica,sans-Serif" font-size="16.00">WSS Connection &amp; Authentication</text>
</g>
<!-- MobileApp -->
<g id="node1" class="node">
<title>MobileApp</title>
<polygon fill="#cce5ff" stroke="black" points="415.73,-263.2 310.27,-263.2 310.27,-221.6 415.73,-221.6 415.73,-263.2"/>
<text text-anchor="middle" x="363" y="-246.6" font-family="Helvetica,sans-Serif" font-size="14.00">Mobile App</text>
<text text-anchor="middle" x="363" y="-229.8" font-family="Helvetica,sans-Serif" font-size="14.00">(React Native)</text>
</g>
<!-- PythonServer -->
<g id="node2" class="node">
<title>PythonServer</title>
<polygon fill="#ffe5b4" stroke="black" points="582.91,-152 433.09,-152 433.09,-110.4 582.91,-110.4 582.91,-152"/>
<text text-anchor="middle" x="508" y="-135.4" font-family="Helvetica,sans-Serif" font-size="14.00">Python Server</text>
<text text-anchor="middle" x="508" y="-118.6" font-family="Helvetica,sans-Serif" font-size="14.00">(WebSocket Handler)</text>
</g>
<!-- MobileApp&#45;&gt;PythonServer -->
<g id="edge1" class="edge">
<title>MobileApp-&gt;PythonServer</title>
<path fill="none" stroke="#007bff" d="M310.11,-238.95C223.56,-234.4 59.5,-223.26 42.02,-203.6 32.1,-192.44 31.9,-180.98 42.02,-170 54.69,-156.27 290.21,-142.73 421.44,-136.22"/>
<polygon fill="#007bff" stroke="#007bff" points="421.32,-139.73 431.13,-135.74 420.97,-132.74 421.32,-139.73"/>
<text text-anchor="middle" x="119.01" y="-182.6" font-family="Times,serif" font-size="14.00">1. Initiate WSS Connection</text>
</g>
<!-- MobileApp&#45;&gt;PythonServer -->
<g id="edge4" class="edge">
<title>MobileApp-&gt;PythonServer</title>
<path fill="none" stroke="#28a745" d="M309.99,-234.74C272.51,-228.81 226.94,-218.71 215.2,-203.6 206.04,-191.8 205.34,-181.22 215.2,-170 228.76,-154.58 340.03,-143.66 421.39,-137.64"/>
<polygon fill="#28a745" stroke="#28a745" points="421.43,-141.15 431.15,-136.93 420.93,-134.16 421.43,-141.15"/>
<text text-anchor="middle" x="348.6" y="-191" font-family="Times,serif" font-size="14.00">3. Send Auth Message</text>
<text text-anchor="middle" x="348.6" y="-174.2" font-family="Times,serif" font-size="14.00">{"type": "auth", "token": "SECRET_TOKEN"}</text>
</g>
<!-- TLSNote -->
<g id="node3" class="node">
<title>TLSNote</title>
<polygon fill="#d9edf7" stroke="black" points="141.97,-152 16.03,-152 16.03,-110.4 147.97,-110.4 147.97,-146 141.97,-152"/>
<polyline fill="none" stroke="black" points="141.97,-152 141.97,-146"/>
<polyline fill="none" stroke="black" points="147.97,-146 141.97,-146"/>
<text text-anchor="middle" x="82" y="-135.4" font-family="Helvetica,sans-Serif" font-size="14.00">TLS Handshake</text>
<text text-anchor="middle" x="82" y="-118.6" font-family="Helvetica,sans-Serif" font-size="14.00">(Encryption Setup)</text>
</g>
<!-- MobileApp&#45;&gt;TLSNote -->
<g id="edge2" class="edge">
<title>MobileApp-&gt;TLSNote</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M310.08,-239.17C221.06,-234.88 49.23,-224.02 31,-203.6 21.06,-192.46 24.28,-183.34 31,-170 34.42,-163.21 39.7,-157.33 45.59,-152.37"/>
</g>
<!-- PythonServer&#45;&gt;MobileApp -->
<g id="edge3" class="edge">
<title>PythonServer-&gt;MobileApp</title>
<path fill="none" stroke="#007bff" d="M506.81,-152.36C504.81,-168.29 499.58,-190.03 486,-203.6 470.33,-219.26 448.34,-228.46 427.28,-233.85"/>
<polygon fill="#007bff" stroke="#007bff" points="426.51,-230.44 417.53,-236.07 428.06,-237.27 426.51,-230.44"/>
<text text-anchor="middle" x="587.79" y="-182.6" font-family="Times,serif" font-size="14.00">2. Complete WSS Connection</text>
</g>
<!-- PythonServer&#45;&gt;MobileApp -->
<g id="edge7" class="edge">
<title>PythonServer-&gt;MobileApp</title>
<path fill="none" stroke="green" d="M583.32,-139.95C641.87,-148.9 708.17,-167.32 676,-203.6 659.8,-221.88 514.04,-233.04 427.25,-238.13"/>
<polygon fill="green" stroke="green" points="427.23,-234.62 417.45,-238.69 427.63,-241.61 427.23,-234.62"/>
<text text-anchor="middle" x="785.1" y="-191" font-family="Times,serif" font-size="14.00">4a. Auth Success</text>
<text text-anchor="middle" x="785.1" y="-174.2" font-family="Times,serif" font-size="14.00">{"type": "auth_ack", "status": "ok"}</text>
</g>
<!-- PythonServer&#45;&gt;MobileApp -->
<g id="edge9" class="edge">
<title>PythonServer-&gt;MobileApp</title>
<path fill="none" stroke="red" d="M583.25,-134.32C688.69,-138.09 869.84,-147.74 890,-170 900.03,-181.07 900.17,-192.67 890,-203.6 859.07,-236.83 560.79,-241.27 427.17,-241.58"/>
<polygon fill="red" stroke="red" points="427.43,-238.08 417.43,-241.59 427.44,-245.08 427.43,-238.08"/>
<text text-anchor="middle" x="1000.63" y="-191" font-family="Times,serif" font-size="14.00">4b. Auth Failure</text>
<text text-anchor="middle" x="1000.63" y="-174.2" font-family="Times,serif" font-size="14.00">{"type": "auth_ack", "status": "fail"}</text>
</g>
<!-- ValidateNote -->
<g id="node4" class="node">
<title>ValidateNote</title>
<polygon fill="#f9f9f9" stroke="black" points="304.76,-54.8 149.24,-54.8 149.24,-18.8 310.76,-18.8 310.76,-48.8 304.76,-54.8"/>
<polyline fill="none" stroke="black" points="304.76,-54.8 304.76,-48.8"/>
<polyline fill="none" stroke="black" points="310.76,-48.8 304.76,-48.8"/>
<text text-anchor="middle" x="230" y="-32.6" font-family="Helvetica,sans-Serif" font-size="14.00">Server Validates Token</text>
</g>
<!-- PythonServer&#45;&gt;ValidateNote -->
<g id="edge5" class="edge">
<title>PythonServer-&gt;ValidateNote</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M446.99,-109.92C397.76,-93.56 329.24,-70.78 282.45,-55.23"/>
</g>
<!-- AuthValid -->
<g id="node5" class="node">
<title>AuthValid</title>
<polygon fill="#f0f0f0" stroke="black" points="424,-54.8 328.68,-36.8 424,-18.8 519.32,-36.8 424,-54.8"/>
<text text-anchor="middle" x="424" y="-32.6" font-family="Helvetica,sans-Serif" font-size="14.00">Token Valid?</text>
</g>
<!-- PythonServer&#45;&gt;AuthValid -->
<g id="edge6" class="edge">
<title>PythonServer-&gt;AuthValid</title>
<path fill="none" stroke="gray" stroke-dasharray="1,5" d="M489.77,-110.15C476.62,-95.69 458.84,-76.12 445.08,-60.99"/>
<polygon fill="gray" stroke="gray" points="447.84,-58.82 438.52,-53.78 442.66,-63.53 447.84,-58.82"/>
<text text-anchor="middle" x="497.23" y="-79.8" font-family="Times,serif" font-size="14.00">Validate</text>
</g>
<!-- AuthSuccessNote -->
<g id="node6" class="node">
<title>AuthSuccessNote</title>
<polygon fill="#d4edda" stroke="black" points="714.25,-57.6 537.75,-57.6 537.75,-16 720.25,-16 720.25,-51.6 714.25,-57.6"/>
<polyline fill="none" stroke="black" points="714.25,-57.6 714.25,-51.6"/>
<polyline fill="none" stroke="black" points="720.25,-51.6 714.25,-51.6"/>
<text text-anchor="middle" x="629" y="-41" font-family="Helvetica,sans-Serif" font-size="14.00">Client Authenticated</text>
<text text-anchor="middle" x="629" y="-24.2" font-family="Helvetica,sans-Serif" font-size="14.00">Accepts further commands</text>
</g>
<!-- PythonServer&#45;&gt;AuthSuccessNote -->
<g id="edge8" class="edge">
<title>PythonServer-&gt;AuthSuccessNote</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M534.55,-109.92C554.73,-94.52 582.35,-73.42 602.51,-58.03"/>
</g>
<!-- AuthFailNote -->
<g id="node7" class="node">
<title>AuthFailNote</title>
<polygon fill="#f8d7da" stroke="black" points="881.54,-57.6 738.46,-57.6 738.46,-16 887.54,-16 887.54,-51.6 881.54,-57.6"/>
<polyline fill="none" stroke="black" points="881.54,-57.6 881.54,-51.6"/>
<polyline fill="none" stroke="black" points="887.54,-51.6 881.54,-51.6"/>
<text text-anchor="middle" x="813" y="-41" font-family="Helvetica,sans-Serif" font-size="14.00">Reject commands</text>
<text text-anchor="middle" x="813" y="-24.2" font-family="Helvetica,sans-Serif" font-size="14.00">Optionally disconnect</text>
</g>
<!-- PythonServer&#45;&gt;AuthFailNote -->
<g id="edge10" class="edge">
<title>PythonServer-&gt;AuthFailNote</title>
<path fill="none" stroke="gray" stroke-dasharray="5,2" d="M574.93,-109.92C625.79,-94.52 695.41,-73.42 746.22,-58.03"/>
</g>
</g>
</svg>